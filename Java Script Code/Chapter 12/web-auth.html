<!DOCTYPE html>
<html>
<head>
  <title>WebAuthn Demo</title>
</head>
<body>
  <h1>Register with Biometrics (WebAuthn)</h1>
  <button onclick="register()">Register</button>

  <script>
    function bufferFromString(str) {
      return Uint8Array.from(str, c => c.charCodeAt(0));
    }

    async function register() {
      try {
        const credential = await navigator.credentials.create({
          publicKey: {
            challenge: bufferFromString("random-challenge-from-server"),
            rp: {
              name: "My Demo App"
            },
            user: {
              id: bufferFromString("user-id-123"),
              name: "user@example.com",
              displayName: "Jane Doe"
            },
            pubKeyCredParams: [
              { type: "public-key", alg: -7 } // ES256 algorithm
            ],
            authenticatorSelection: {
              authenticatorAttachment: "platform", // use built-in like fingerprint
              userVerification: "required"
            },
            timeout: 60000,
            attestation: "none"
          }
        });

        console.log("✅ Credential created successfully:", credential);
        alert("Credential created! Check console for details.");
      } catch (err) {
        console.error("❌ Registration failed:", err);
        alert("Registration failed: " + err.message);
      }
    }
  </script>
</body>
</html>
